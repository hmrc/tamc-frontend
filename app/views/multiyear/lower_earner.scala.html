@*
 * Copyright 2023 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import config.ApplicationConfig
@import java.text.NumberFormat
@import models.auth.UserRequest
@import includes.{ErrorSummary, InputRadios, PageHeading, Button, P}

@this(
main: main,
errorSummary: ErrorSummary,
inputRadios: InputRadios,
pageHeading: PageHeading,
p: P,
button: Button,
form: FormWithCSRF,
applicationConfig: ApplicationConfig)

@(lowerEarnerFormInput: Form[(MultiYearLowerEarnerFormInput)])(
    implicit messages: Messages, request: UserRequest[_])

@main(
    pageTitle = Some(Messages("title.eligibility.pattern", Messages("eligibility.check.lower.earner.h1", NumberFormat.getIntegerInstance().format(applicationConfig.PERSONAL_ALLOWANCE())))),
    backLinkHref = Some(controllers.routes.EligibilityController.doYouLiveInScotland.url)
){

    @errorSummary(lowerEarnerFormInput, Some("lower-earner-true"))

    @pageHeading(classes=Some("govuk-!-margin-bottom-3 govuk-heading-xl"),
                    context = "This section is ",
                    section = "eligibility.check.span.h1",
                    text = Messages("eligibility.check.lower.earner.h1", NumberFormat.getIntegerInstance().format(applicationConfig.PERSONAL_ALLOWANCE()))
        )

    @form(action = routes.EligibilityController.lowerEarnerCheckAction, args = ('id -> "income-form")) {
        @p(HtmlContent(Messages("eligibility.check.lower.earner.information2")), elmId = Some("lower-earner-information"))
        
        @inputRadios(
            form = lowerEarnerFormInput,
            legend = Messages("eligibility.check.lower.earner.h1", NumberFormat.getIntegerInstance().format(applicationConfig.PERSONAL_ALLOWANCE())),
            id = Some("lower-earner"),
            name = "lower-earner",
            items = Seq(RadioItem(
                            content = Text(messages("radio.yes")),
                            value = Some("true"),
                            id = Some("lower-earner-true")
                        ), RadioItem(
                            content = Text(messages("radio.no")),
                            value = Some("false"),
                            id = Some("lower-earner-false")
                        )
                    ),
            fieldSetAttrs = Map("data-inline-error" -> "inline-lower-earner-error"),
            legendAsHeading = false,
            legendClasses = "govuk-visually-hidden"
        )

    <div class="tamc-js-hidden error-inline validation-summary" id="inline-lower-earner-error">
        @p(Text(Messages("eligibility.check.lower.earner.error", NumberFormat.getIntegerInstance().format(applicationConfig.PERSONAL_ALLOWANCE()))))
    </div>

    @button(msg = "generic.continue", id = "continue", attrs = Map("data-journey-click" -> "marriage-allowance:click:advance-from-eligibility-questions"))

    }
}
