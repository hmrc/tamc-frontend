@*
 * Copyright 2022 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import config.ApplicationConfig
@import java.text.NumberFormat
@import uk.gov.hmrc.time.TaxYear._
@import views.helpers.LanguageUtilsImpl
@import models.auth.UserRequest
@import includes.{H1, H2, P, Link, Button}

@this(
main: main,
applicationConfig: ApplicationConfig,
languageUtilsImpl: LanguageUtilsImpl,
h1: H1,
h2: H2,
p: P,
link: Link,
button: Button,
insetText: GovukInsetText)

@()(implicit messages: Messages,
request: UserRequest[_])

@main(
pageTitle = Some(Messages("title.pattern", Messages("title.how-it-works"))),
disableBackLink = true
){

    @h1("generic.ma.apply")

    @p(HtmlContent(ledeContent))
    @p(Text(Messages("pages.how-it-works.lede-pre2", NumberFormat.getIntegerInstance().format(applicationConfig.MAX_BENEFIT()))))
    @p(Text(Messages("pages.how-it-works.lede-pre4", NumberFormat.getIntegerInstance().format(applicationConfig.PERSONAL_ALLOWANCE()))))


    @insetText(InsetText(content = Text(Messages("pages.how-it-works.lede-pre5"))))

    @p(Text(Messages("pages.how-it-works.lede-pre6")))

    @h2("pages.how-it-works.apply.heading")
    @p(Text(Messages("pages.how-it-works.detail")))
    @p(Text(Messages("pages.how-it-works.email")))

    @p(HtmlContent(button(msg = "generic.start-now",
                        href = Some(controllers.routes.EligibilityController.ptaCalculator.url),
                        attrs = Map("data-transaction-slug" -> "marriage-allowance"),
                        id = "start-now",
                        classes = Some("govuk-!-margin-bottom-0"),
                        isStartButton = true) +
                    s"""<span class="destination"> ${Messages("pages.how-it-works.tse")} </span>"""), 
        elmId=Some("get-started"),
        classes=Some("get-started"))

}

@ledeContent = {
    @if(languageUtilsImpl.isWelsh(messages)) {
        @messages("pages.how-it-works.lede-pre1.part1")
    } 
    @link(link = applicationConfig.marriageAllowanceGuideUrl, messageKey = "pages.how-it-works.lede-pre1.link-text", attrTarget = true, inParagraph = true)
    @messages("pages.how-it-works.lede-pre1.part2", NumberFormat.getIntegerInstance().format(applicationConfig.MAX_ALLOWED_PERSONAL_ALLOWANCE_TRANSFER()))
}